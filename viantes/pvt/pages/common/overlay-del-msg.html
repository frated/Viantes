<script>
/* Cancella o ripristina i messaggi selezionati del tab corrente */
function delOrRestoreMsg() {

	$('#overlay-loadImg').show();
	$('#overlay-del-msg').hide();

	var tabactive = $('#tabactive').val();
	var isRrestore = $('#isRrestore').val(); 
	var mode = ( tabactive == '4' && isRrestore ==  '1') ? '5' : tabactive;
	
	//Ciclo sull'oggetto check box e prendo solo euqlli checked
	var objId = 'input[name=delMsgTab'+ tabactive + ']';
	var msgList = '';
	$(objId).each(function () {
		if (this.checked) {
			var id = this.value;
			msgList +=  ( msgList == '' ) ? id : ';' + id;
		}
	});
	
	//se non trovo nulla cerco un eventuale campo hidden (vuol dire che vengo dalla pagina showMsg.php)
	if (msgList == '')	msgList = $('#delMsgShoMsg').val();
	
	$.ajax({
		type: "GET",
		url: "/viantes/pvt/pages/msg/delOrRestoreMsg.php",
		data: "msgList=" + msgList + "&mode=" + mode,
		dataType: "html",
		success: function(response){
			$('#overlay-loadImg').hide();	
			window.location.href = window.location.origin + "/viantes/pub/pages/profile/message.php?tabactive=" + tabactive;
		},
		error: function(){
			//no action
		}
	});
}
</script>
<div id="overlay-del-msg" class="overlay" style="display: none;" >
	<div class="del-item-main-ovly-ie7 main-overlay">
		<div class="overlay-common-msg-center">
		
			<h3 class="overlay-common-msg-h3"><?php echo $X_langArray['OVERLAY_DEL_MSG_TITLE']?></h3>
			
			<p id="overlay-del-msg-question1" ><?php echo $X_langArray['OVERLAY_DEL_MSG_QUESTION']?></p>
			<p id="overlay-del-msg-question2" class="hidden"><?php echo $X_langArray['OVERLAY_RESTORE_MSG_QUESTION']?></p>
			
			<button class="overlay-common-but personalButton" onclick="javascript:delOrRestoreMsg();">
				<?php echo $X_langArray['OVERLAY_DEL_MSG_ANSW_YES']?>
			</button>
			<button class="overlay-common-but personalButton" onclick="$('#overlay-del-msg').hide();">
				<?php echo $X_langArray['OVERLAY_DEL_MSG_ANSW_CANC']?>
			</button>
		</div>
	</div>
</div>
